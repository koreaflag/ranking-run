# RUNVS API â€” Caddy reverse proxy
#
# Usage:
#   - Set DOMAIN env var to your domain for auto HTTPS (e.g. api.runvs.app)
#   - Leave DOMAIN unset or empty to use HTTP-only mode (IP access)
#   - DNS A record must point to this server's IP for HTTPS

:80 {
	# Reverse proxy to FastAPI backend
	reverse_proxy backend:8000

	# Response headers
	header {
		# Security headers
		X-Content-Type-Options nosniff
		X-Frame-Options DENY
		Referrer-Policy strict-origin-when-cross-origin
		# Remove server identity
		-Server
	}

	# Gzip compression
	encode gzip

	# Access logging
	log {
		output stdout
		format json
	}
}
